<h1 id="memo-tbd">Memo (TBD)<a aria-hidden="true" class="anchor-heading icon-link" href="#memo-tbd"></a></h1>
<blockquote>
<p>정리 필요</p>
</blockquote>
<pre class="language-python"><code class="language-python">   
<span class="token number">1.</span> Imputation

threshold <span class="token operator">=</span> <span class="token number">0.7</span>

<span class="token comment"># Dropping columns with missing value rate higher than threshold</span>
data <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>columns<span class="token punctuation">[</span>data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&#x3C;</span> threshold<span class="token punctuation">]</span>

<span class="token comment"># Dropping rows with missing value rate higher than threshold</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&#x3C;</span> threshold<span class="token punctuation">]</span>

<span class="token comment"># Filling all missing values with 0</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># Filling missing values with medians of the columns</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>data<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Max fill function for categorical columns</span>
data<span class="token punctuation">[</span><span class="token string">'column_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'column_name'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token number">2.</span> Hangling Outliers

<span class="token comment"># Dropping the outlier rows with standard deviation</span>
factor <span class="token operator">=</span> <span class="token number">3</span>
upper_lim <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor
upper_lim <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor

data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span> <span class="token operator">&#x3C;</span> upper_lim<span class="token punctuation">)</span> <span class="token operator">&#x26;</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span> <span class="token operator">></span> lower_lim<span class="token punctuation">)</span> <span class="token punctuation">]</span>       

<span class="token comment"># Dropping the outlier rows with Percentiles</span>
upper_lim <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">.95</span><span class="token punctuation">)</span>
lower_lim <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">.05</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span> <span class="token operator">&#x3C;</span> upper_lim<span class="token punctuation">)</span> <span class="token operator">&#x26;</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span> <span class="token operator">></span> lower_lim<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token number">3.</span> Binning

<span class="token comment"># Numerical Binning Example</span>

Value	   Bin
<span class="token number">0</span><span class="token operator">-</span><span class="token number">30</span>	<span class="token operator">-</span><span class="token operator">></span> Low
<span class="token number">31</span><span class="token operator">-</span><span class="token number">70</span>	<span class="token operator">-</span><span class="token operator">></span> Mid
<span class="token number">71</span><span class="token operator">-</span><span class="token number">100</span>	<span class="token operator">-</span><span class="token operator">></span> High     

<span class="token comment"># Categorical Binning Example</span>

Value	   Bin
Spain	<span class="token operator">-</span><span class="token operator">></span> Europe
Italy	<span class="token operator">-</span><span class="token operator">></span> Europe
Chile	<span class="token operator">-</span><span class="token operator">></span> South America
Brazil	<span class="token operator">-</span><span class="token operator">></span> South America      

<span class="token comment"># Numerical Binning Example</span>

data<span class="token punctuation">[</span><span class="token string">'bin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"Low"</span><span class="token punctuation">,</span> <span class="token string">"Mid"</span><span class="token punctuation">,</span> <span class="token string">"High"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    value   <span class="token builtin">bin</span>
 <span class="token number">0</span>      <span class="token number">2</span>   Low
 <span class="token number">1</span>     <span class="token number">45</span>   Mid
 <span class="token number">2</span>      <span class="token number">7</span>   Low
 <span class="token number">3</span>     <span class="token number">85</span>  High
 <span class="token number">4</span>     <span class="token number">28</span>   Low  

<span class="token comment"># Categorical Binning Example</span>

      Country
 <span class="token number">0</span>      Spain
 <span class="token number">1</span>      Chile
 <span class="token number">2</span>  Australia
 <span class="token number">3</span>      Italy
 <span class="token number">4</span>     Brazil   

conditions <span class="token operator">=</span> <span class="token punctuation">[</span>
	data<span class="token punctuation">[</span><span class="token string">'Country'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'Spain'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	data<span class="token punctuation">[</span><span class="token string">'Country'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'Italy'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	data<span class="token punctuation">[</span><span class="token string">'Country'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'Chile'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	data<span class="token punctuation">[</span><span class="token string">'Country'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">'Brazil'</span><span class="token punctuation">)</span>  
<span class="token punctuation">]</span>

choices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Europe'</span><span class="token punctuation">,</span> <span class="token string">'Europe'</span><span class="token punctuation">,</span> <span class="token string">'South America'</span><span class="token punctuation">,</span> <span class="token string">'South America'</span><span class="token punctuation">]</span>  

data<span class="token punctuation">[</span><span class="token string">'Continent'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>select<span class="token punctuation">(</span>conditions<span class="token punctuation">,</span> choices<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'Other'</span><span class="token punctuation">)</span> 

<span class="token number">4.</span> Log Transform

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token number">5.</span> One<span class="token operator">-</span>hot encoding

encoded_columns <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'column'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>join<span class="token punctuation">(</span>encoded_columns<span class="token punctuation">)</span><span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'column'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token number">6.</span> Group Operations

data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Pivot table Pandas Example</span>

data<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">'column_to_group'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'column_to_encode'</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'aggregation_column'</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span> fill_value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>

grouped <span class="token operator">=</span> data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'column_to_group'</span><span class="token punctuation">)</span>

sums <span class="token operator">=</span> grouped<span class="token punctuation">[</span>sum_cols<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_suffix<span class="token punctuation">(</span><span class="token string">'_sum'</span><span class="token punctuation">)</span>
avgs <span class="token operator">=</span> grouped<span class="token punctuation">[</span>mean_cols<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_suffix<span class="token punctuation">(</span><span class="token string">'_avg'</span><span class="token punctuation">)</span>

new_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>sums<span class="token punctuation">,</span> avgs<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  

<span class="token number">7.</span> Feature Split

data<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 

data<span class="token punctuation">.</span>title<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> expand<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token number">8.</span> Scaling

<span class="token comment"># Normalization</span>

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">)</span>      

data<span class="token punctuation">[</span><span class="token string">'normalized'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span>
	<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Standardization</span>

data<span class="token punctuation">[</span><span class="token string">'standardized'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> 
	data<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token number">9.</span> Extracting Date

<span class="token keyword">from</span> datetime <span class="token keyword">import</span> date

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'date'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'01-01-2017'</span><span class="token punctuation">,</span><span class="token string">'04-12-2008'</span><span class="token punctuation">,</span><span class="token string">'23-06-1988'</span><span class="token punctuation">,</span><span class="token string">'25-08-1999'</span><span class="token punctuation">,</span><span class="token string">'20-02-1993'</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># Transform string to date</span>
data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">.</span>date<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"%d-%m-%Y"</span><span class="token punctuation">)</span>

<span class="token comment"># Extracting Year</span>
data<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year

<span class="token comment"># Extracting Month</span>
data<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month

<span class="token comment"># Extracting passed years since the date </span>
data<span class="token punctuation">[</span><span class="token string">'passed_years'</span><span class="token punctuation">]</span> <span class="token operator">=</span> date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year

<span class="token comment"># Extracting passed months since the date</span>
data<span class="token punctuation">[</span><span class="token string">'passed_months'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">12</span> <span class="token operator">+</span> date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>month <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month

<span class="token comment"># Extracting the weekday name of the date</span>
data<span class="token punctuation">[</span><span class="token string">'day_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>day_name<span class="token punctuation">(</span><span class="token punctuation">)</span> 

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

<span class="token comment"># Drop columns that have too many missing value </span>
null <span class="token operator">=</span> train<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
train1 <span class="token operator">=</span> train
test1 <span class="token operator">=</span> test
train1<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'aaa'</span><span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">,</span> <span class="token string">'ccc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
test1<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'aaa'</span><span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">,</span> <span class="token string">'ccc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># y, X 설정</span>
y <span class="token operator">=</span> train1<span class="token punctuation">[</span><span class="token string">'SalePrice'</span><span class="token punctuation">]</span>
X <span class="token operator">=</span> train1<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'SalePrice'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># boolean field 설정</span>
train1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
fence_map <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'MnPrv'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'GdWo'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'GdPrv'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'MnWw'</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span>
train1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>fence_map<span class="token punctuation">)</span>
test1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>fence_map<span class="token punctuation">)</span>

<span class="token comment"># null 처리</span>
train1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>     
test1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test1<span class="token punctuation">[</span><span class="token string">'Fence'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

train1<span class="token punctuation">[</span><span class="token string">'GarageCond'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
train1<span class="token punctuation">[</span><span class="token string">'GarageCond'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train1<span class="token punctuation">[</span><span class="token string">'GarageCond'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'TA'</span><span class="token punctuation">)</span>
test1<span class="token punctuation">[</span><span class="token string">'GarageCond'</span><span class="token punctuation">]</span> <span class="token operator">=</span> test1<span class="token punctuation">[</span><span class="token string">'GarageCond'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">'TA'</span><span class="token punctuation">)</span>

<span class="token comment"># 숫자를 문자열로 변환</span>
train1<span class="token punctuation">[</span><span class="token string">'MoSold'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train1<span class="token punctuation">[</span><span class="token string">'MoSold'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>

<span class="token comment"># 컬럼의 값의 개수</span>
test<span class="token punctuation">[</span><span class="token string">'MSZoning'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 컬럼 두 개를 하나로 합치기(Merge)</span>
train1<span class="token punctuation">[</span><span class="token string">'Condition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> train1<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'Condition1'</span><span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'Condition2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'Condition1'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>'Condition2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
train1<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Condition1'</span><span class="token punctuation">,</span> <span class="token string">'Condition2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> 
     
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span> 

<span class="token keyword">def</span> <span class="token function">date_preprocessing</span><span class="token punctuation">(</span>dataframe<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df <span class="token operator">=</span> dataframe<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'일자'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'일자'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'년도'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'일자'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year
    df<span class="token punctuation">[</span><span class="token string">'월'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'일자'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month
    df<span class="token punctuation">[</span><span class="token string">'일'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'일자'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>day
    df<span class="token punctuation">[</span><span class="token string">'주'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'일자'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>weekday
    <span class="token keyword">return</span> df   
</code></pre>