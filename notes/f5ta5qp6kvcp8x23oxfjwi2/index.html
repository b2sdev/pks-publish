<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/pks-publish/favicon.ico"/><title>Delta Lake</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Delta Lake"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://b2sdev.github.io/pks-publish/notes/f5ta5qp6kvcp8x23oxfjwi2/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="11/29/2022"/><meta property="article:modified_time" content="9/3/2023"/><link rel="canonical" href="https://b2sdev.github.io/pks-publish/notes/f5ta5qp6kvcp8x23oxfjwi2/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/pks-publish/_next/static/css/3646adbe9f4978fb.css" as="style"/><link rel="stylesheet" href="/pks-publish/_next/static/css/3646adbe9f4978fb.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/pks-publish/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/pks-publish/_next/static/chunks/webpack-76e99ab115ade130.js" defer=""></script><script src="/pks-publish/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/pks-publish/_next/static/chunks/main-599200d9a16403bb.js" defer=""></script><script src="/pks-publish/_next/static/chunks/pages/_app-6eff3c921e9661a4.js" defer=""></script><script src="/pks-publish/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/pks-publish/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/pks-publish/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/pks-publish/_next/static/MBpMZiPEoVJLwa6Uvfsj2/_buildManifest.js" defer=""></script><script src="/pks-publish/_next/static/MBpMZiPEoVJLwa6Uvfsj2/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="delta-lake">Delta Lake<a aria-hidden="true" class="anchor-heading icon-link" href="#delta-lake"></a></h1>
<h2 id="what">What<a aria-hidden="true" class="anchor-heading icon-link" href="#what"></a></h2>
<ul>
<li>an open source ACID table storage layer over cloud object stores</li>
<li>parquet 데이터 파일을 확장<br>
ㄴ How? transaction log를 추가하여 <br>
ㄴ So? <a href="/pks-publish/notes/i77f7bz5g58kgrwmzz5rf07">ACID 트랜잭션</a>을 제공하고, 확장 가능한 메타데이터를 처리</li>
<li>Apache Spark API 와 완벽하게 호환되며 <a href="/pks-publish/notes/cmfutyhgtl88lr1sike6zta">Structured Streaming</a>과의 긴밀하게 통합됨
<br>
ㄴ So? 일괄 처리 및 스트리밍 작업 모두에 단일 데이터 복사본을 쉽게 사용하고, 대규모 증분 처리를 제공할 수 있음</li>
<li>Databricks의 <a href="/pks-publish/notes/2b76tsb8q0aqabl8uww9at1">Data Lakehouse</a> 플랫폼에서는 데이터 및 테이블을 저장하기 위한 기반을 제공하는 최적화된 <code>스토리지 계층</code>으로 사용됨</li>
</ul>
<blockquote>
<p>Delta Lake is an open source ACID table storage layer over cloud object stores initially
developed at Databricks. Delta Lake uses a transaction log that is
compacted into Apache Parquet format to provide ACID properties,
time travel, and significantly faster metadata operations for large
tabular datasets (e.g., the ability to quickly search billions of table
partitions for those relevant to a query). It also leverages this design to provide high-level features such as automatic data layout
optimization, upserts, caching, and audit logs.</p>
</blockquote>
<h2 id="why">WHY<a aria-hidden="true" class="anchor-heading icon-link" href="#why"></a></h2>
<ul>
<li><a href="/pks-publish/notes/eja9cwc6rjfx4zrkmvrp8az">Data Lake</a>는 Schema Enforcement, Data Quality, ACID Transaction 등을 지원하지 않음</li>
<li>이러한 Data Lakes의 결점을 Delta Lake로 극복할 수 있음</li>
</ul>
<h2 id="z-ordering">Z-ordering<a aria-hidden="true" class="anchor-heading icon-link" href="#z-ordering"></a></h2>
<ul>
<li>Z-ordering is a technique to colocate related information in the same set of files. This co-locality is automatically used by Delta Lake on Databricks data-skipping algorithms. This behavior dramatically reduces the amount of data that Delta Lake on Databricks needs to read. </li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">OPTIMIZE</span> events
<span class="token keyword">WHERE</span> <span class="token keyword">date</span> <span class="token operator">>=</span> <span class="token keyword">current_timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">day</span>
ZORDER <span class="token keyword">BY</span> <span class="token punctuation">(</span>eventType<span class="token punctuation">)</span>
</code></pre>
<h2 id="reference">Reference<a aria-hidden="true" class="anchor-heading icon-link" href="#reference"></a></h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/databricks/delta/">https://learn.microsoft.com/en-us/azure/databricks/delta/</a></li>
<li><a href="https://www.databricks.com/wp-content/uploads/2020/08/p975-armbrust.pdf">https://www.databricks.com/wp-content/uploads/2020/08/p975-armbrust.pdf</a></li>
<li><a href="https://www.linkedin.com/pulse/delta-lake-tables-umair-yelurkar">https://www.linkedin.com/pulse/delta-lake-tables-umair-yelurkar</a></li>
</ul>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/pks-publish/notes/0wwj1byxg3uhkh6el05q2o9">Data+AI Summit 2022 키노트 주요 어나운스먼트 요약</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#what" title="What">What</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#why" title="WHY">WHY</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#z-ordering" title="Z-ordering">Z-ordering</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#reference" title="Reference">Reference</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"f5ta5qp6kvcp8x23oxfjwi2","title":"Delta Lake","desc":"","updated":1693717299550,"created":1669726561783,"custom":{},"fname":"dev.data+ai.databricks.delta_lake","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Dendron"},"contentHash":"abdc571178fea7bdcbc1200c6663302d","links":[{"type":"wiki","from":{"fname":"dev.data+ai.databricks.delta_lake","id":"f5ta5qp6kvcp8x23oxfjwi2","vaultName":"Dendron"},"value":"dev.cs.database.ACID","position":{"start":{"line":6,"column":11,"offset":149},"end":{"line":6,"column":35,"offset":173},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"dev.cs.database.ACID"}},{"type":"wiki","from":{"fname":"dev.data+ai.databricks.delta_lake","id":"f5ta5qp6kvcp8x23oxfjwi2","vaultName":"Dendron"},"value":"dev.data+ai.spark.structured_streaming","position":{"start":{"line":7,"column":32,"offset":229},"end":{"line":7,"column":74,"offset":271},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"dev.data+ai.spark.structured_streaming"}},{"type":"wiki","from":{"fname":"dev.data+ai.databricks.delta_lake","id":"f5ta5qp6kvcp8x23oxfjwi2","vaultName":"Dendron"},"value":"dev.data+ai.databricks.data_lakehouse","position":{"start":{"line":10,"column":15,"offset":373},"end":{"line":10,"column":56,"offset":414},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"dev.data+ai.databricks.data_lakehouse"}},{"type":"wiki","from":{"fname":"dev.data+ai.databricks.delta_lake","id":"f5ta5qp6kvcp8x23oxfjwi2","vaultName":"Dendron"},"value":"dev.data+ai.data_lake","position":{"start":{"line":21,"column":3,"offset":1027},"end":{"line":21,"column":28,"offset":1052},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"dev.data+ai.data_lake"}},{"from":{"fname":"dev.data+ai.databricks.data+ai-summit-2022-keynote-summary","id":"0wwj1byxg3uhkh6el05q2o9","vaultName":"Dendron"},"type":"backlink","position":{"start":{"line":5,"column":3,"offset":44},"end":{"line":5,"column":40,"offset":81},"indent":[]},"value":"dev.data+ai.databricks.delta_lake"}],"anchors":{"what":{"type":"header","text":"What","value":"what","line":8,"column":0,"depth":2},"why":{"type":"header","text":"WHY","value":"why","line":26,"column":0,"depth":2},"z-ordering":{"type":"header","text":"Z-ordering","value":"z-ordering","line":30,"column":0,"depth":2},"reference":{"type":"header","text":"Reference","value":"reference","line":39,"column":0,"depth":2}},"children":[],"parent":"skeuhenz2vf0ycgfmyy8pl1","data":{}},"body":"\u003ch1 id=\"delta-lake\"\u003eDelta Lake\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#delta-lake\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"what\"\u003eWhat\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003ean open source ACID table storage layer over cloud object stores\u003c/li\u003e\n\u003cli\u003eparquet 데이터 파일을 확장\u003cbr\u003e\nㄴ How? transaction log를 추가하여 \u003cbr\u003e\nㄴ So? \u003ca href=\"/pks-publish/notes/i77f7bz5g58kgrwmzz5rf07\"\u003eACID 트랜잭션\u003c/a\u003e을 제공하고, 확장 가능한 메타데이터를 처리\u003c/li\u003e\n\u003cli\u003eApache Spark API 와 완벽하게 호환되며 \u003ca href=\"/pks-publish/notes/cmfutyhgtl88lr1sike6zta\"\u003eStructured Streaming\u003c/a\u003e과의 긴밀하게 통합됨\n\u003cbr\u003e\nㄴ So? 일괄 처리 및 스트리밍 작업 모두에 단일 데이터 복사본을 쉽게 사용하고, 대규모 증분 처리를 제공할 수 있음\u003c/li\u003e\n\u003cli\u003eDatabricks의 \u003ca href=\"/pks-publish/notes/2b76tsb8q0aqabl8uww9at1\"\u003eData Lakehouse\u003c/a\u003e 플랫폼에서는 데이터 및 테이블을 저장하기 위한 기반을 제공하는 최적화된 \u003ccode\u003e스토리지 계층\u003c/code\u003e으로 사용됨\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDelta Lake is an open source ACID table storage layer over cloud object stores initially\ndeveloped at Databricks. Delta Lake uses a transaction log that is\ncompacted into Apache Parquet format to provide ACID properties,\ntime travel, and significantly faster metadata operations for large\ntabular datasets (e.g., the ability to quickly search billions of table\npartitions for those relevant to a query). It also leverages this design to provide high-level features such as automatic data layout\noptimization, upserts, caching, and audit logs.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"why\"\u003eWHY\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#why\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/pks-publish/notes/eja9cwc6rjfx4zrkmvrp8az\"\u003eData Lake\u003c/a\u003e는 Schema Enforcement, Data Quality, ACID Transaction 등을 지원하지 않음\u003c/li\u003e\n\u003cli\u003e이러한 Data Lakes의 결점을 Delta Lake로 극복할 수 있음\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"z-ordering\"\u003eZ-ordering\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#z-ordering\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eZ-ordering is a technique to colocate related information in the same set of files. This co-locality is automatically used by Delta Lake on Databricks data-skipping algorithms. This behavior dramatically reduces the amount of data that Delta Lake on Databricks needs to read. \u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eOPTIMIZE\u003c/span\u003e events\n\u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecurrent_timestamp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTERVAL\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eday\u003c/span\u003e\nZORDER \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eeventType\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"reference\"\u003eReference\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#reference\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://learn.microsoft.com/en-us/azure/databricks/delta/\"\u003ehttps://learn.microsoft.com/en-us/azure/databricks/delta/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.databricks.com/wp-content/uploads/2020/08/p975-armbrust.pdf\"\u003ehttps://www.databricks.com/wp-content/uploads/2020/08/p975-armbrust.pdf\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.linkedin.com/pulse/delta-lake-tables-umair-yelurkar\"\u003ehttps://www.linkedin.com/pulse/delta-lake-tables-umair-yelurkar\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/pks-publish/notes/0wwj1byxg3uhkh6el05q2o9\"\u003eData+AI Summit 2022 키노트 주요 어나운스먼트 요약\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"rfaecb1r4pxpahsrighqpfi","title":"Dev","desc":"","updated":1666489926104,"created":1666489926104,"custom":{"nav_order":0,"permalink":"/"},"fname":"dev","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Dendron"},"contentHash":"5f3d9b993bc1c60c0e10119b00a45c49","links":[],"anchors":{},"children":["vmcgt1bw13lwsobet50r3vl","pj0dbesw2qm5j1tub9f34pg","e40hlh2wukm75vo4t8r9c7p","7xwnx64er01irhu8wg1q5zm","4buyekecqhzdg87aqxmh1rz","n1xmefdyaaztqb8wmsmqtjj","d8p9jq81rc0pfbbuzz7prah","yq2839iijurmzkrwkqwo9ps","51sfhirev9l2r8bef9utfb9","xuw6kyksesfaatsmt3gctyi","njc2zpmxz8izls7ogwdj20h","d3ma1d2r59fhejrl6bn9g0e","tgd9pt1fu1j4ejm4g09vlx4","5jlkrg4hx6dpy5tr55grkh6","ockg1gb78gpshwty5zjmvue","owsm2ti22dslhpk9oduhhku","52x2zgp7jpygai1h0jpv0t8","2d5oqog2rsdfdogne54tq9t"],"parent":null,"data":{},"body":""},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"Dendron"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["dev","about"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Golbang Hacker","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","assetsPrefix":"/pks-publish","siteUrl":"https://b2sdev.github.io","theme":"dark","siteFaviconPath":"favicon.ico","siteIndex":"dev"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"f5ta5qp6kvcp8x23oxfjwi2"},"buildId":"MBpMZiPEoVJLwa6Uvfsj2","assetPrefix":"/pks-publish","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>